@page "/senior/{Year:int}/{ContestantId:int}"
@page "/junior/{Year:int}/{ContestantId:int}"
@using Microsoft.AspNetCore.Components.QuickGrid
@inherits BaseEurovisionPage

<main>

    <div class="title">
        <EurovisionHeartFlag CountryCode="@Contestant.CountryCode"/>
        <div>
            <p>Eurovision @Contest.Year @Contestant.CountryName</p>
            <p>@Contestant.Artist - "@Contestant.Song"</p>
        </div>
        <EurovisionHeartFlag CountryCode="@Contestant.CountryCode"/>
    </div>

    @if (Contestant.Videos.Count > 0)
    {
        <div class="yt-video">
            <iframe src="@Contestant.Videos[0]" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        </div>
    }

    <div class="data-container">
        <div class="contest-data">
            <p><span class="data-entry">Song:</span> @Contestant.Song</p>
            <p><span class="data-entry">Artist:</span> @Contestant.Artist</p>
            @if (!string.IsNullOrEmpty(Contestant.Backings))
            {
                <p><span class="data-entry">Backings:</span> @Contestant.Backings</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Broadcaster))
            {
                <p><span class="data-entry">Broadcaster:</span> @Contestant.Broadcaster</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Commentators))
            {
                <p><span class="data-entry">Commentators:</span> @Contestant.Commentators</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Composers))
            {
                <p><span class="data-entry">Composers:</span> @Contestant.Composers</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Conductor))
            {
                <p><span class="data-entry">Conductor:</span> @Contestant.Conductor</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Dancers))
            {
                <p><span class="data-entry">Dancers:</span> @Contestant.Dancers</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Spokesperson))
            {
                <p><span class="data-entry">Spokesperson:</span> @Contestant.Spokesperson</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.StageDirector))
            {
                <p><span class="data-entry">Stage director:</span> @Contestant.StageDirector</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Writers))
            {
                <p><span class="data-entry">Writers:</span> @Contestant.Writers</p>
            }
            @if (Contestant.Bpm.HasValue)
            {
                <p><span class="data-entry">Beats per minute:</span> @Contestant.Bpm</p>
            }
            @if (!string.IsNullOrEmpty(Contestant.Tone))
            {
                <p><span class="data-entry">Tone:</span> @Contestant.Tone</p>
            }
            
        </div>

        <div>
            <p>RESULT @Contest.Year</p>
            <div>
                <div>PLACE</div>
                <div>POINTS</div>
            </div>
            <div>RUNNING ORDER: 2</div>
        </div>
    </div>

    @if (!string.IsNullOrEmpty(Contestant.Tone))
    {
        @CreateArmorMusicSheet()
    }

    @if (!Contestant.Lyrics.IsNullOrEmpty())
    {
        string[][][] columns = GetLyricsColumns();
        var lyricsSelected = Contestant.Lyrics[LyricsSelectedIndex];

        <div class="lyrics">
            <div class="lyrics-header">
                <span>Lyrics</span>

                <InputSelect @bind-Value="LyricsSelectedIndex">
                    @for (int i = 0; i < Contestant.Lyrics.Count; i++)
                    {
                        var lyrics = Contestant.Lyrics[i];
                        <option value="@i">@lyrics.Languages[0]</option>
                    }
                </InputSelect>
            </div>

            <p class="lyrics-title">@lyricsSelected.Title</p>

            <div class="lyrics-content">
                @for (int columnIndex = 0; columnIndex < columns.Length; columnIndex++)
                {
                    string[][] column = columns[columnIndex];
                    <div>
                        @for (int paragraphIndex = 0; paragraphIndex < column.Length; paragraphIndex++)
                        {
                            string[] lines = column[paragraphIndex];
                            <p>
                                @for (int lineIndex = 0; lineIndex < lines.Length; lineIndex++)
                                {
                                    string line = lines[lineIndex];
                                    @lines[lineIndex]
                                    if (lineIndex != lines.Length - 1) { <br /> }
                                }
                            </p>
                        }
                    </div>
                }
            </div>
        </div>
    }
</main>